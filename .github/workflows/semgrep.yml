name: Security Scan - SAST

on: [push, pull_request]

jobs:
  sast_scan:
    runs-on: ubuntu-latest
    steps:
      # Step 1: Checkout the code
      - uses: actions/checkout@v4

      # Step 2: Set up environment (e.g., Python, Node.js) if required for the scanner
      - name: Set up Python
        uses: actions/setup-python@v5
        with:
          python-version: '3.x'

      # Step 3: Run Semgrep SAST Scan
      - name: Run Semgrep scan
        # Uses Semgrep's official action for easy integration
        uses: returntocorp/semgrep-action@v2
        with:
          # Define the specific security ruleset to use (e.g., based on OWASP Top 10)
          config: auto
          # Generate output in SARIF format for GitHub Security tab integration
          publish: 'on-failure'
          # Critical: Define a rule failure threshold to break the pipeline!
          # Fails the build if any High-severity finding is detected
          fail_on_error: true
          fail_on: "error" # Equivalent to High/Critical severity
